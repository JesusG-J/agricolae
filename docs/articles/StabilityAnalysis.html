<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stability Analysis with **agricolae** • agricolae</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Stability Analysis with **agricolae**">
<meta property="og:description" content="agricolae">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-116716530-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-116716530-2');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">agricolae</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-code"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-o"></span>
     
    Tutorial
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Intro_agricolae.html">Introduction to agricolae</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Introduction.html">Introduction to agricolae</a>
    </li>
    <li>
      <a href="../articles/DescriptiveStats.html">Descriptive Statistics with agricolae</a>
    </li>
    <li>
      <a href="../articles/ExperimentalDesign.html">Experimental Design with agricolae</a>
    </li>
    <li>
      <a href="../articles/MultipleComparisons.html">Multiple Comparisons with agricolae</a>
    </li>
    <li>
      <a href="../articles/Non-parametricComparisons.html">Non-parametric Comparisons with agricolae</a>
    </li>
    <li>
      <a href="../articles/GraphicsMultipleComparisons.html">Graphics of the Multiple Comparisons with agricolae</a>
    </li>
    <li>
      <a href="../articles/StabilityAnalysis.html">Stability Analysis with agricolae</a>
    </li>
    <li>
      <a href="../articles/SpecialFunctions.html">Special Functions in agricolae</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/myaseen208/agricolae">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://www.researchgate.net/profile/Muhammad_Yaseen10">RG</a>
</li>
<li>
  <a href="https://twitter.com/myaseen208">
    <span class="fab fa fab fa-twitter"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Stability Analysis with <strong>agricolae</strong>
</h1>
                        <h4 class="author">Felipe de Mendiburu<sup>1</sup>, Muhammad Yaseen<sup>2</sup>
</h4>
            
            <h4 class="date">2020-05-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/myaseen208/agricolae/blob/master/vignettes/StabilityAnalysis.Rmd"><code>vignettes/StabilityAnalysis.Rmd</code></a></small>
      <div class="hidden name"><code>StabilityAnalysis.Rmd</code></div>

    </div>

    
    
<p>
</p>
<ol style="list-style-type: decimal">
<li>Professor of the Academic Department of Statistics and Informatics of the Faculty of Economics and Planning.National University Agraria La Molina-PERU.
</li>
</ol>
<p>
</p>
<ol start="2" style="list-style-type: decimal">
<li>Department of Mathematics and Statistics, University of Agriculture Faisalabad, Pakistan.
</li>
</ol>
<div id="stability-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#stability-analysis" class="anchor"></a>Stability Analysis</h1>
<p>In <strong>agricolae</strong> there are two methods for the study of stability and the AMMI model. These are: a parametric model for a simultaneous selection in yield and stability “SHUKLA’S STABILITY VARIANCE AND KANG’S”, <span class="citation">(Kang, <a href="#ref-Kang:1993" role="doc-biblioref">1993</a>)</span> and a non-parametric method of Haynes, based on the data range.</p>
<div id="parametric-stability" class="section level2">
<h2 class="hasAnchor">
<a href="#parametric-stability" class="anchor"></a>Parametric Stability</h2>
<p>Use the parametric model, function <code>stability.par</code>.</p>
<p>Prepare a data table where the rows and the columns are the genotypes and the environments, respectively. The data should correspond to yield averages or to another measured variable. Determine the variance of the common error for all the environments and the number of repetitions that was evaluated for every genotype. If the repetitions are different, find a harmonious average that will represent the set. Finally, assign a name to each row that will represent the genotype <span class="citation">(Kang, <a href="#ref-Kang:1993" role="doc-biblioref">1993</a>)</span>. We will consider five environments in the following example:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span>(<span class="kw">digit</span><span class="kw">=</span><span class="fl">2</span>)
<span class="no">f</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"external/dataStb.csv"</span>, <span class="kw">package</span><span class="kw">=</span><span class="st">"agricolae"</span>)
<span class="no">dataStb</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span>(<span class="no">f</span>)
<span class="fu"><a href="../reference/stability.par.html">stability.par</a></span>(<span class="no">dataStb</span>, <span class="kw">rep</span><span class="kw">=</span><span class="fl">4</span>, <span class="kw">MSerror</span><span class="kw">=</span><span class="fl">1.8</span>, <span class="kw">alpha</span><span class="kw">=</span><span class="fl">0.1</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"Genotype"</span>,<span class="kw">console</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<pre><code>
 INTERACTIVE PROGRAM FOR CALCULATING SHUKLA'S STABILITY VARIANCE AND KANG'S
                        YIELD - STABILITY (YSi) STATISTICS
 Genotype 
 Environmental index  - covariate 

 Analysis of Variance

               Df    Sum Sq  Mean Sq F value Pr(&gt;F)
Total         203 2964.1716                        
Genotypes      16  186.9082  11.6818    4.17 &lt;0.001
Environments   11 2284.0116 207.6374  115.35 &lt;0.001
Interaction   176  493.2518   2.8026    1.56 &lt;0.001
Heterogeneity  16   44.8576   2.8036       1  0.459
Residual      160  448.3942   2.8025    1.56 &lt;0.001
Pooled Error  576                1.8               

 Genotype. Stability statistics

      Mean Sigma-square  . s-square  . Ecovalence
A 7.383333     2.474081 ns 2.449076 ns  25.826563
B 6.783333     1.600869 ns 1.434734 ns  17.351269
C 7.250000     0.567657 ns 0.633936 ns   7.323033
D 6.783333     2.611778 ns 2.134731 ns  27.163033
E 7.066667     1.862364 ns 2.047627 ns  19.889308
F 6.916667     3.575818  * 3.951442  *  36.519896
G 7.808333     3.580929  * 3.957319  *  36.569504
H 7.908333     2.723717 ns 2.118116 ns  28.249504
I 7.275000     4.248566 ** 3.936130  *  43.049504
J 7.083333     2.273838 ns 2.506382 ns  23.883033
K 6.433333     2.560384 ns 2.551518 ns  26.664210
L 6.891667     1.558061 ns 1.732557 ns  16.935779
M 6.791667     3.483879  * 3.275985 ns  35.627543
N 7.491667     5.164848 ** 4.875189 **  51.942837
O 7.658333     2.380202 ns 2.635025 ns  24.915386
P 6.425000     3.445414  * 3.713885  *  35.254210
Q 6.158333     3.531232  * 3.688232  *  36.087151


Signif. codes:  0 '**' 0.01 '*' 0.05 'ns' 1

Simultaneous selection for yield and stability  (++)

     Yield Rank Adj.rank Adjusted Stab.var Stab.rating YSi ...
A 7.383333   13        1       14 2.474081           0  14   +
B 6.783333    4       -1        3 1.600869           0   3    
C 7.250000   11        1       12 0.567657           0  12   +
D 6.783333    4       -1        3 2.611778           0   3    
E 7.066667    9        1       10 1.862364           0  10   +
F 6.916667    8       -1        7 3.575818          -4   3    
G 7.808333   16        2       18 3.580929          -4  14   +
H 7.908333   17        2       19 2.723717           0  19   +
I 7.275000   12        1       13 4.248566          -8   5    
J 7.083333   10        1       11 2.273838           0  11   +
K 6.433333    3       -2        1 2.560384           0   1    
L 6.891667    7       -1        6 1.558061           0   6    
M 6.791667    6       -1        5 3.483879          -4   1    
N 7.491667   14        1       15 5.164848          -8   7   +
O 7.658333   15        2       17 2.380202           0  17   +
P 6.425000    2       -2        0 3.445414          -4  -4    
Q 6.158333    1       -3       -2 3.531232          -4  -6    

 Yield Mean: 7.065196
 YS    Mean: 6.823529
 LSD (0.05): 0.4511874
 - - - - - - - - - - -
 +   selected genotype
 ++  Reference: Kang, M. S. 1993. Simultaneous selection for yield
 and stability: Consequences for growers. Agron. J. 85:754-757.</code></pre>
<p>For 17 genotypes, the identification is made by letters. An error variance of 2 and 4 repetitions is assumed.</p>
<div id="analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#analysis" class="anchor"></a>Analysis</h3>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">output</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/stability.par.html">stability.par</a></span>(<span class="no">dataStb</span>, <span class="kw">rep</span><span class="kw">=</span><span class="fl">4</span>, <span class="kw">MSerror</span><span class="kw">=</span><span class="fl">2</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">output</span>)</pre></body></html></div>
<pre><code>[1] "analysis"   "statistics" "stability" </code></pre>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">output</span>$<span class="no">stability</span>)</pre></body></html></div>
<pre><code>     Yield Rank Adj.rank Adjusted Stab.var Stab.rating YSi ...
A 7.383333   13        1       14 2.474081           0  14   +
B 6.783333    4       -1        3 1.600869           0   3    
C 7.250000   11        1       12 0.567657           0  12   +
D 6.783333    4       -1        3 2.611778           0   3    
E 7.066667    9        1       10 1.862364           0  10   +
F 6.916667    8       -1        7 3.575818          -2   5    
G 7.808333   16        2       18 3.580929          -2  16   +
H 7.908333   17        2       19 2.723717           0  19   +
I 7.275000   12        1       13 4.248566          -4   9   +
J 7.083333   10        1       11 2.273838           0  11   +
K 6.433333    3       -2        1 2.560384           0   1    
L 6.891667    7       -1        6 1.558061           0   6    
M 6.791667    6       -1        5 3.483879          -2   3    
N 7.491667   14        1       15 5.164848          -8   7    
O 7.658333   15        2       17 2.380202           0  17   +
P 6.425000    2       -2        0 3.445414          -2  -2    
Q 6.158333    1       -2       -1 3.531232          -2  -3    </code></pre>
<p>The selected genotypes are: A, C, E, G, H, I, J and O. These genotypes have a higher yield and a lower variation. to see output$analysis, the interaction is significant.</p>
<p>If for example there is an environmental index, it can be added as a covariate In the first five locations. For this case, the altitude of the localities is included.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">data5</span><span class="kw">&lt;-</span><span class="no">dataStb</span>[,<span class="fl">1</span>:<span class="fl">5</span>]
<span class="no">altitude</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1200</span>, <span class="fl">1300</span>, <span class="fl">800</span>, <span class="fl">1600</span>, <span class="fl">2400</span>)
<span class="no">stability</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/stability.par.html">stability.par</a></span>(<span class="no">data5</span>,<span class="kw">rep</span><span class="kw">=</span><span class="fl">4</span>,<span class="kw">MSerror</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">cova</span><span class="kw">=</span><span class="fl">TRUE</span>, <span class="kw">name.cov</span><span class="kw">=</span> <span class="st">"altitude"</span>,
<span class="kw">file.cov</span><span class="kw">=</span><span class="no">altitude</span>)</pre></body></html></div>
</div>
</div>
<div id="non-parametric-stability" class="section level2">
<h2 class="hasAnchor">
<a href="#non-parametric-stability" class="anchor"></a>Non-parametric Stability</h2>
<p>For non-parametric stability, the function in <strong>agricolae</strong> is <code><a href="../reference/stability.nonpar.html">stability.nonpar()</a></code>. The names of the genotypes should be included in the first column, and in the other columns, the response by environments <span class="citation">(Haynes et al., <a href="#ref-HaynLambChriWeinDoucBackSecoFryStev:1998" role="doc-biblioref">1998</a>)</span>.</p>
<div id="analysis-1" class="section level3">
<h3 class="hasAnchor">
<a href="#analysis-1" class="anchor"></a>Analysis</h3>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">name</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html">row.names</a></span>(<span class="no">dataStb</span>), <span class="no">dataStb</span>)
<span class="no">output</span><span class="kw">&lt;-</span><span class="fu"><a href="../reference/stability.nonpar.html">stability.nonpar</a></span>(<span class="no">data</span>, <span class="st">"YIELD"</span>, <span class="kw">ranking</span><span class="kw">=</span><span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">output</span>)</pre></body></html></div>
<pre><code>[1] "ranking"    "statistics"</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">output</span>$<span class="no">statistics</span></pre></body></html></div>
<pre><code>      MEAN      es1 es2       vs1      vs2  chi.ind  chi.sum
1 7.065196 5.647059  24 0.7247475 46.72727 8.843605 27.58711</code></pre>
</div>
</div>
<div id="ammi" class="section level2">
<h2 class="hasAnchor">
<a href="#ammi" class="anchor"></a>AMMI</h2>
<p>The model AMMI uses the biplot constructed through the principal components generated by the interaction environment-genotype. If there is such interaction, the percentage of the two principal components would explain more than the 50% of the total variation; in such case, the biplot would be a good alternative to study the interaction environment-genotype <span class="citation">(Crossa, <a href="#ref-Cros:1990" role="doc-biblioref">1990</a>)</span>.</p>
<p>The data for AMMI should come from similar experiments conducted in different environments. Homogeneity of variance of the experimental error, produced in the different environments, is required. The analysis is done by combining the experiments.</p>
<p>The data can be organized in columns, thus: environment, genotype, repetition, and variable.</p>
<p>The data can also be the averages of the genotypes in each environment, but it is necessary to consider a harmonious average for the repetitions and a common variance of the error. The data should be organized in columns: environment, genotype, and variable.</p>
<p>When performing AMMI, this generates the Biplot, Triplot and Influence graphics, see Figure @ref(fig:f6).</p>
<p>For the application, we consider the data used in the example of parametric stability (study):</p>
<div id="ammi-structure" class="section level3">
<h3 class="hasAnchor">
<a href="#ammi-structure" class="anchor"></a>AMMI structure</h3>
<div class="sourceCode" id="cb12"><html><body><pre class="r">  <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">AMMI</span>)</pre></body></html></div>
<pre><code>function (ENV, GEN, REP, Y, MSE = 0, console = FALSE, PC = FALSE)  </code></pre>
</div>
<div id="plot-ammi-structure-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#plot-ammi-structure-plot" class="anchor"></a>plot.AMMI structure, plot()</h3>
<div class="sourceCode" id="cb14"><html><body><pre class="r">  <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">plot.AMMI</span>)</pre></body></html></div>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">plrv</span>)
<span class="no">model</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">plrv</span>,<span class="fu"><a href="../reference/AMMI.html">AMMI</a></span>(<span class="no">Locality</span>, <span class="no">Genotype</span>, <span class="no">Rep</span>, <span class="no">Yield</span>, <span class="kw">console</span><span class="kw">=</span><span class="fl">FALSE</span>))
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">model</span>)</pre></body></html></div>
<pre><code>[1] "ANOVA"    "genXenv"  "analysis" "means"    "biplot"   "PC"      </code></pre>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">model</span>$<span class="no">ANOVA</span></pre></body></html></div>
<pre><code>Analysis of Variance Table

Response: Y
           Df Sum Sq Mean Sq  F value    Pr(&gt;F)    
ENV         5 122284 24456.9 257.0382  9.08e-12 ***
REP(ENV)   12   1142    95.1   2.5694  0.002889 ** 
GEN        27  17533   649.4  17.5359 &lt; 2.2e-16 ***
ENV:GEN   135  23762   176.0   4.7531 &lt; 2.2e-16 ***
Residuals 324  11998    37.0                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">model</span>$<span class="no">analysis</span></pre></body></html></div>
<pre><code>    percent  acum Df     Sum.Sq   Mean.Sq F.value   Pr.F
PC1    56.3  56.3 31 13368.5954 431.24501   11.65 0.0000
PC2    27.1  83.3 29  6427.5799 221.64069    5.99 0.0000
PC3     9.4  92.7 27  2241.9398  83.03481    2.24 0.0005
PC4     4.3  97.1 25  1027.5785  41.10314    1.11 0.3286
PC5     2.9 100.0 23   696.1012  30.26527    0.82 0.7059</code></pre>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">pc</span> <span class="kw">&lt;-</span> <span class="no">model</span>$<span class="no">analysis</span>[, <span class="fl">1</span>]
<span class="no">pc12</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">pc</span>[<span class="fl">1</span>:<span class="fl">2</span>])
<span class="no">pc123</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="no">pc</span>[<span class="fl">1</span>:<span class="fl">3</span>])</pre></body></html></div>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">oldpar</span><span class="kw">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">cex</span><span class="kw">=</span><span class="fl">0.4</span>,<span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">model</span>,<span class="kw">type</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">las</span><span class="kw">=</span><span class="fl">1</span>,<span class="kw">xlim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">5</span>,<span class="fl">6</span>))</pre></body></html></div>
<div class="figure">
<img src="StabilityAnalysis_files/figure-html/f6-1.png" alt="Biplot" width="700"><p class="caption">
Biplot
</p>
</div>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="no">oldpar</span>)</pre></body></html></div>
<p>In this case, the interaction is significant. The first two components explain 83.4 %; then the biplot can provide information about the interaction genotype-environment. With the triplot, 92.8% would be explained.</p>
<p><strong>To triplot require klaR package. in R execute:</strong></p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">model</span>,<span class="kw">type</span><span class="kw">=</span><span class="fl">2</span>,<span class="kw">las</span><span class="kw">=</span><span class="fl">1</span>)</pre></body></html></div>
</div>
</div>
<div id="ammi-index-and-yield-stability" class="section level2">
<h2 class="hasAnchor">
<a href="#ammi-index-and-yield-stability" class="anchor"></a>AMMI index and yield stability</h2>
<p>Calculate AMMI stability value (ASV) and Yield stability index (YSI) <span class="citation">(Purchase, <a href="#ref-Purc:1997" role="doc-biblioref">1997</a>; N. et al., <a href="#ref-SabaDehg:2008" role="doc-biblioref">2008</a>)</span>.</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">plrv</span>)
<span class="no">model</span><span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span>(<span class="no">plrv</span>,<span class="fu"><a href="../reference/AMMI.html">AMMI</a></span>(<span class="no">Locality</span>, <span class="no">Genotype</span>, <span class="no">Rep</span>, <span class="no">Yield</span>, <span class="kw">console</span><span class="kw">=</span><span class="fl">FALSE</span>))
<span class="no">index</span><span class="kw">&lt;-</span><span class="fu"><a href="../reference/index.AMMI.html">index.AMMI</a></span>(<span class="no">model</span>)
<span class="co"># Crops with improved stability according AMMI.</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">index</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">index</span>[,<span class="fl">3</span>]),])</pre></body></html></div>
<pre><code>              ASV YSI rASV rYSI    means
402.7   0.2801470  20    1   19 27.47748
364.21  0.7236998  12    2   10 34.05974
506.2   0.7511331  14    3   11 33.26623
233.11  1.0582263  21    4   17 28.66655
427.7   1.1467970  12    5    7 36.19020
104.22  1.4627695  19    6   13 31.28887
241.2   1.6774241  29    7   22 26.34039
221.19  1.8014494  34    8   26 22.98480
317.6   2.1874274  18    9    9 35.32583
121.31  2.2937918  25   10   15 30.10174
406.12  2.5631734  23   11   12 32.68323
314.12  2.9170536  30   12   18 28.17335
342.15  2.9219360  37   13   24 26.01336
351.26  2.9786832  22   14    8 36.11581
Canchan 3.0975884  35   15   20 27.00126
450.3   3.1430174  22   16    6 36.19602
157.26  3.2923168  22   17    5 36.95181
320.16  3.3208950  39   18   21 26.34808
255.7   3.3289736  33   19   14 30.58975
102.18  3.3801820  43   20   23 26.31947
235.6   3.7647078  25   21    4 38.63477
Unica   3.8380782  24   22    2 39.10400
405.2   3.9832546  39   23   16 28.98663
163.9   4.4269636  51   24   27 21.41747
141.28  4.4672401  26   25    1 39.75624
346.2   5.1827747  51   26   25 23.84175
319.20  6.7164864  30   27    3 38.75767
Desiree 7.7833445  56   28   28 16.15569</code></pre>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="co"># Crops with better response and improved stability according AMMI.</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">index</span>[<span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span>(<span class="no">index</span>[,<span class="fl">4</span>]),])</pre></body></html></div>
<pre><code>              ASV YSI rASV rYSI    means
141.28  4.4672401  26   25    1 39.75624
Unica   3.8380782  24   22    2 39.10400
319.20  6.7164864  30   27    3 38.75767
235.6   3.7647078  25   21    4 38.63477
157.26  3.2923168  22   17    5 36.95181
450.3   3.1430174  22   16    6 36.19602
427.7   1.1467970  12    5    7 36.19020
351.26  2.9786832  22   14    8 36.11581
317.6   2.1874274  18    9    9 35.32583
364.21  0.7236998  12    2   10 34.05974
506.2   0.7511331  14    3   11 33.26623
406.12  2.5631734  23   11   12 32.68323
104.22  1.4627695  19    6   13 31.28887
255.7   3.3289736  33   19   14 30.58975
121.31  2.2937918  25   10   15 30.10174
405.2   3.9832546  39   23   16 28.98663
233.11  1.0582263  21    4   17 28.66655
314.12  2.9170536  30   12   18 28.17335
402.7   0.2801470  20    1   19 27.47748
Canchan 3.0975884  35   15   20 27.00126
320.16  3.3208950  39   18   21 26.34808
241.2   1.6774241  29    7   22 26.34039
102.18  3.3801820  43   20   23 26.31947
342.15  2.9219360  37   13   24 26.01336
346.2   5.1827747  51   26   25 23.84175
221.19  1.8014494  34    8   26 22.98480
163.9   4.4269636  51   24   27 21.41747
Desiree 7.7833445  56   28   28 16.15569</code></pre>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Cros:1990">
<p>Crossa, J. (1990). “Statistical Analyses of Multilocation Trials,” in <em>Advances in agronomy</em> (Elsevier), 55–85.</p>
</div>
<div id="ref-HaynLambChriWeinDoucBackSecoFryStev:1998">
<p>Haynes, K. G., Lambert, D. H., Christ, B. J., Weingartner, D. P., Douches, D. S., Backlund, J. E., et al. (1998). Phenotypic stability of resistance to late blight in potato clones evaluated at eight sites in the United Stated. 75, 211–217.</p>
</div>
<div id="ref-Kang:1993">
<p>Kang, M. S. (1993). Phenotypic stability of resistance to late blight in potato clones evaluated at eight sites in the United Stated. <em>Agronomy Journal</em> 85, 754–757.</p>
</div>
<div id="ref-SabaDehg:2008">
<p>N., S., H.Sabaghpour, S., and Dehghani, H. (2008). The use of an AMMI model and its parameters to analyse yield stability in multienvironment trials. <em>Journal of Agricultural Science</em> 146, 571–581.</p>
</div>
<div id="ref-Purc:1997">
<p>Purchase, J. L. (1997). Parametric analysis to describe genotype environment interaction and yield stability in winter wheat.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Felipe de Mendiburu, Muhammad Yaseen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'bdafb7ea4490644e670f470ee3ef537f',
    indexName: 'agricolae',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
